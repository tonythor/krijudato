---
title: "Project 3 Ferris"
format: revealjs
editor: visual
---

```{r}
source("functions.r") 
library(dplyr)
library(tidyr)
library(ggplot2)
options(scipen=999)
wide_stack <- get_stack_df(persist = TRUE, load_from_cache = TRUE)
```

## Question 1: Which countries have the highest average salaries? Which careers have the highest average salaries? What job titles in the United States have the highest average salaries?

## Data Formatting

```{r}

AvgSalaries <- wide_stack |> 
  filter(!is.na(AnnualSalary)) |> 
  group_by(Country) |> 
  summarise(AvgSalary = mean(AnnualSalary, na.rm = TRUE)) |>
  arrange(desc(AvgSalary)) |>
  head(n = 11)

ggplot(AvgSalaries, aes(x = Country, y = AvgSalary)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Top 10 Average Salaries by Country")


library(stringr)
tempWideStack <- wide_stack
tempWideStack[c('DevType', 'To.Delete')] <- str_split_fixed(tempWideStack$DevType, ';', 2)
tempWideStack <- tempWideStack[,-45]

AvgSalaries <- tempWideStack |> 
  filter(!is.na(AnnualSalary)) |> 
  group_by(DevType) |> 
  summarise(AvgSalary = mean(AnnualSalary, na.rm = TRUE)) |>
  arrange(desc(AvgSalary)) |>
  head(n = 20)

ggplot(AvgSalaries, aes(x = DevType, y = AvgSalary)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Top 20 Average Salaries by Developer Type")


AvgSalaries <- tempWideStack |> 
  filter(!is.na(AnnualSalary)) |> 
  group_by(DevType) |>
  filter((Country == "United States") | (Country == "United States of America")) |>
  summarise(AvgSalary = mean(AnnualSalary, na.rm = TRUE)) |>
  arrange(desc(AvgSalary)) |>
  head(n = 20)

ggplot(AvgSalaries, aes(x = DevType, y = AvgSalary)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Top 20 Average Salaries in the U.S. by Developer Type")

AvgSalaries <- AvgSalaries |> filter(DevType != "Blockchain")
ggplot(AvgSalaries, aes(x = DevType, y = AvgSalary)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Top 19 Average Salaries in the U.S. by Developer Type", subtitle = "Excluding Blockchain Developers")

```

## Conclusions

Monaco and Afghanistan were the countries with the two highest average annual salaries. Blockchain developers appeared the have the highest salary, but this might be a typo or outlier. Besides blockchain developers, project managers and senior executives had the highest average annual salaries. Specifically in the U.S., blockchain developers also had the highest average annual salaries. Like the rest of the world, project managers and senior executives had the highest annual salaries out of all the job titles.

## Question 2: How does job status relate to type of degree?

## Data Formatting

```{r}
jobsAndDegrees <- data.frame(JobStatus = tempWideStack$Employment,
                             Degree = tempWideStack$EdLevel)

jobsAndDegrees$JobStatus <- gsub(".*Employed, full-time.*","Employed, full-time",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Employed, part-time.*","Employed, part-time",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Not employed.*","Not employed",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*self-employed.*","Self-employed",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*I prefer not to say.*",NA,jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Retired.*","Retired",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Student.*","Student",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Employed part-time.*","Employed, part-time",jobsAndDegrees$JobStatus)
jobsAndDegrees$JobStatus <- gsub(".*Employed full-time.*","Employed, full-time",jobsAndDegrees$JobStatus)

jobsAndDegrees$Degree <- gsub(".*Associate.*","Associate's",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Bachelor.*","Bachelor's",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Master.*","Master's",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*doctoral.*","Doctorate",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Bachelor.*","Bachelor's",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Some college.*","Some college",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Doctoral.*","Doctorate",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Secondary.*","High School",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*prefer.*",NA,jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*never.*", NA, jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Professional.*","Professional",jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Primary.*",NA,jobsAndDegrees$Degree)
jobsAndDegrees$Degree <- gsub(".*Something.*",NA,jobsAndDegrees$Degree)

jobsAndDegrees <- jobsAndDegrees |>
  filter(!is.na(Degree)) |>
  filter(!is.na(JobStatus))
ggplot(jobsAndDegrees, aes(Degree, ..count..)) + 
  geom_bar(aes(fill = JobStatus), position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Count of People with a Specific Job Status by Degree")


  
```

## Conclusions

It seems that the most number of people have a Bachelor's degree and are employed full-time. People are most likely to be employed full-time if they have a Bachelor's degree, Master's degree, or completed some college. Also, people who have a Bachelor's degree are more likely to be self-employed than any other degree. People who only completed high school are most likely to be unemployed. Since most people who took the survey had Bachelor's degrees based on these counts, it may have skewed the results. Also, people are more likely to take this survey if they are employed because they may use Stack Overflow to help them while working at their job.

## Question 3: How does organization size relate to the number of years professionally coding?

## Data Formatting

```{r}

ggplot(wide_stack, aes(x = YearsCodeProAvg, y = OrgSizeAvg)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Top 10 Average Salaries by Country")

```

## Conclusions

It appears that people of all coding experience work for organizations of all different sizes. Most people have coded 0 to 20 years, but people of all coding experiences work for small organizations, medium-sized organizations, and large organizations. There does not seem to be any relationship. The decision to employ workers, and the decision to work at a particular-size company is likely determined on a individual basis. Most organizations likely try to employ people of all different experience levels. Some employees need a lot of experience, while others will gain that experience on the job.
